<!-- BEGIN- Show Pipeline Options and Name/Title -->
<div class="row ">
  <div id="pipeDataDiv" class="large-8 columns panel">
    <!-- Displays title of the pipeline -->
    <div id="showDataDiv">
      <h2>{{pipeline.name}}</h2>
      <a href="/#/pipeline/{{pipeline_id}}/stages" class="button tiny">Add Stages & Fields</a>
      <a href="/#/pipeline/{{pipeline_id}}/users/" class="button tiny">Manage Collaborators</a>
      <a ng-click="BoxService.sendEmailToSelected()" class="button tiny">Send Email</a>
    </div>
  </div>
</div>
<!-- END- Show Pipeline Options and Name/Title -->

<!-- BEGIN- Stages Partition -->
<div class="row">
  <div class="columns text-center large-centered">
    <h3>Stages</h3>
  </div>
</div>
<!-- END- Stages Partition -->

<!-- BEGIN- Show Stage information tables -->
<div class="row">

  <button ng-click="BoxService.toggleAllContactSelection();">Select/Deselect All</button>

  <div class="" ng-repeat="stage in stages">
    <div class="row panel">
      <h3>{{stage.name}}</h3>
      <p>{{stage.description}}</p>
    </div>
    <table>
      <!-- Heading for fields in your pipeline -->
      <thead>
        <tr>
          <th>
            <input type="checkbox" ng-model="stage.selection" ng-change="BoxService.toggleStageSelection(stage)">
          </th>
          <th>Details</th>
          <th>Stage</th>
          <th ng-repeat="field in basicFields">{{field.field_name | titleCase}}</th>
          <th ng-repeat="field in fields">{{field.field_name | titleCase}}</th>
        </tr>
      </thead>
      <tbody ng-controller="PipelineDetailsCtrl">

        <tr ng-repeat="contact in stageContacts[stage.id]">
          <!-- | orderBy:'contact.contacts.name'" -->
          <!-- Display actual data for your contact -->
          <td>
            <input type="checkbox" ng-model="contact.selected">
          </td>
          <td>
            <a href="/#/pipeline/{{pipeline_id}}/contact/{{contact.id}}"
              class="button detail-button tiny radius round">Details</a>
          </td>
          <td>
            <form>
              <select
              ng-model="contact.stage"
              ng-options="stageOpt.name for stageOpt in stages"
              ng-selected="contact.stage"
              class="button dropdown detail-button tiny radius round"
              ng-change="BoxService.changeStage(contact, contact.stage)">
              </select>
            </form>
          </td>
          <form id="inputForm">
            <td ng-repeat="field in basicFields">
            <!-- TODO: need to make a input field class here for the text fields -->
              <input type="text" class="tableField" ng-model="contact[field.field_name]" ng-show="contact.showEdit" ng-keyup="updateBoxOnEnter($event, contact)">
              <p ng-hide="contact.showEdit" ng-dblclick="BoxService.toggleEditable(contact)">{{contact[field.field_name]}}</p>
            </td>
            <!-- TODO: need to make a input field class here for the text fields -->
            <td ng-repeat="field in fields">
              <input type="text" class="tableField" ng-model="contact[field.field_name]" ng-show="contact.showEdit" ng-keyup="updateBoxOnEnter($event, contact)">
              <p ng-hide="contact.showEdit" ng-dblclick="BoxService.toggleEditable(contact)">{{contact[field.field_name]}}</p>
            </td>
          </form>
        </tr>
      </tbody>
    </table>
  </div>
</div>
